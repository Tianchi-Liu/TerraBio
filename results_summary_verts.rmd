---
title: "Summary of TerraBio eDNA Results"
author: "Karen Dyson"
date: "8/19/2021"
output:
  word_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
source("data_analysis_VERTS.R")
library(vegan)

```

## Biodiversity Results for the 2g Riaz dataset

Overall, we detected a total of `r totalReadsRiaz_2` reads, describing a total of `r totalMOTURiaz_2` MOTU representing `r totalUniqueTaxon_2` unique Family groups.

TerraBio's biodiversity indicators break down into two main components: those describing _key species_ and those describing the entire community of insects/mammals detected.



## Key species indicators

### Key species present in our sample

We found a total of `r length(cocoaKeySpecies) + length(pastureKeySpecies)` key species in our intervention and counterfactual sample (Table 1). A total of `r length(forestKeySpecies)` key species were found in our forest sample.


```{r keySpeciesTable}

knitr::kable(keyVert_2_Table, digits = 4,
             col.names = c("Species ID", "Species Name","Cocoa Mean Abund.", "Cocoa Std. Deviation", "Pasture Mean Abund.", "Pasture Std. Deviation", "Forest Mean Abund.", "Forest Std.Deviation"),
             caption = "Table X: Key vertebrate species found in the TerraBio pilot in cocoa and pasture fields, along with those found in the three forest plots.")


```


### Biodiversity Indicator 4 (ABF-KPI-6): Number of keystone/priority species due to intervention.

We found `r length(keyInCocoaOnly)` species present in cocoa fields (intervention) that were not present in pasture (counterfactual). These include: `r paste(unique(keyInCocoaOnly), sep = ", ")`.

Additionally, we found `r length(keyInPastureOnly)`` species present in pasture not present in cocoa fields. These include: `r paste(unique(keyInPastureOnly), sep = ", ")`.

`r length(keyInBoth)` species were present in both cocoa and pasture fields, while we did not detect `r length(keyInNeither)` species in either location. `r length(keyInForestOnly)` key species were only found in forests.

We tested to see if any of the key species are associated with (indicative of) either cocoa fields or pasture and the ecological conditions found there (Bakker, 2008; De Caceres et al., 2012; Table 2). However, no indicator species were detected.


```{r indicatorSpecies, include=F}

# knitr::kable(indicatorSpecies[indicatorSpecies$frequency.sp > 0.79, ], 
#              caption = "Table X: Key species that are indicator species for either cocoa fields or pastures.",
#              col.names = c("Field Type", "Species", "Frequency", "Mean Indicator Stat", "Minimum p Value", "Maximum p value"))

# indicator species were found for XXX (`r paste(indicatorSpecies$species)`; Table X).


```

### Question 1.8: Does the number (richness) or abundance of key species change over time compared to the counterfactual?

As this pilot only included one time period, we compared the intervention to the counterfactual for this one time period. The number (richness) and abundance of key species for each plot and field is shown in Table X. 

```{r tbSpeciesChange}

knitr::kable(tbSpeciesChange[ , c("siteNames", "siteField", "siteType", "keySpeciesCount", "keySpeciesAbundance", "allSpeciesRichness", "allAbundance")], 
             col.names = c("Plot", "Field ID", "Field Type", "Mean Species Richn.", "Mean Species Abund.", "All Species Richn.", "All Species Abund."), digits = 4,
             caption = "Table X: Richness and abundance of key species and all species found in the TerraBio pilot in cocoa and pasture fields.")

```


When comparing key species richness between cocoa fields (intervention) and pasture (counterfactuals), We found that there was no significant difference in key species richness (Pr(>Chisq) = `r test_keySpeciesCountLMER[3] %>% round(4)`; Fig. X). 


```{r plotTBSpeciesCount, fig.cap="Figure 1: Key species richness by field site.", fig.width= 8.5, echo=FALSE}

plotTBSpeciesCount + theme(legend.position="bottom")

```

When comparing key species abundance between cocoa fields (intervention) and pasture (counterfactuals), We found that there was also no significant difference in key species abundance (Pr(>Chisq) = `r test_keySpeciesAbundanceLMER[3] %>% round(4)`; Fig. X). 



```{r plotTBSpeciesAbundance, fig.cap="Figure 2: Key species abundance (reads) by field site. Relative abundance is measured using the number of reads.", fig.width=8.5, echo=FALSE}

plotTBSpeciesAbundance + theme(legend.position="bottom")


```



## General species richness, abundance, and diversity questions

In addition to examining key species, or species of particular importance, we also examined the community composition of mammal populations found on cocoa fields (intervention) and pastures (counterfactual).

### Question 1.5 & Biodiversity Indicator 6: Does species richness change over time compared to the counterfactual?

The mean species richness in cocoa fields was `r mean(cocoaSpeciesRichness)` species (SD = `r sd(cocoaSpeciesRichness)`), while on pastures mean species richness was `r mean(pastureSpeciesRichness)` (SD = `r sd(pastureSpeciesRichness)`). The number and abundance for all species for each plot and field is shown in Table X.

```{r tbSpeciesChange2, fig.width = 8.5}

select(tbSpeciesChange, siteNames, siteField, siteType, allSpeciesRichness, allAbundance) %>% 
    knitr::kable(caption = "Table X: Richness and abundance of key species found in the TerraBio pilot in cocoa and pasture fields.")

```

When comparing total species richness between cocoa fields (intervention) and pasture (counterfactuals), we found that pasture did have significantly more OTUs associated with each field compared with shaded cocoa fields (Pr(>Chisq) = `r test_allSpeciesRichnessLMER[3]`; Fig. X). While some of this is due to native species (see Figure X above), it is also because the pastures had more OTUs representing domesticated species, including cows, horses, and chickens.


```{r tbSpeciesAllCount, fig.width = 8.5, fig.cap="Figure 3: Total species richness by field site.", echo=FALSE}

tbSpeciesAllCount + theme(legend.position="bottom")

```


### Question 1.6: Does relative abundance of species change over time compared to counterfactual?

When comparing total species abundance between cocoa fields (intervention) and pasture (counterfactuals), we found that they were not significantly different (Pr(>Chisq) = `r test_allSpeciesAbundanceLMER[3] %>% round(4)`; Fig. X). 


```{r tbSpeciesAllAbundance, fig.cap="Figure 4: Total species abundance (reads) by field site. Relative abundance is measured using the number of reads.", echo=FALSE, fig.width = 8.5}

tbSpeciesAllAbundance + theme(legend.position="bottom")

```


### Question 1.7: Are there changes in Shannon’s diversity index (and others) over time compared to the counterfactual? & Biodiversity Indicator 7: Change in biodiversity indices due to interventions.

Results from calculating multiple diversity indices/metrics for each site are shown in Table 5. Overall alpha diversity was `r alphaDiversity`, gamma diversity was `r gammaDiversity`, and beta diversity was `r betaDiversity`.

```{r diversityMetrics, fig.width = 8.5}

knitr::kable(diversityMetrics[order(diversityMetrics$siteNames),], caption = "Table 5: Diversity indices found in the TerraBio pilot in cocoa and pasture fields.", digits = 4)

```

When comparing diversity indicies between cocoa fields (intervention) and pasture (counterfactuals), we found that pastures had higher Shannon's diversity when compared with cocoa fields, again in part due to domestic species OTUs (Pr(>Chisq) = `r test_shannonLMER[3] %>% round(4)`; Fig. X). Similarly, there was also a significant difference found for Effective Species Richness (Pr(>Chisq) = `r test_effectiveSRLMER[3] %>% round(4)`; Fig. X).

```{r graphDiversityMetrics, fig.cap="Figure 5: Diversity metrics--SPECIFIC ADD HERE--by field site.", echo=FALSE,  fig.width = 8.5}

tbSpeciesChange %>%
  ggplot() +
  geom_boxplot(aes(siteField, shannon),
               outlier.shape = NA) +
  geom_jitter(aes(siteField, shannon, color = siteType),
              width = 0.1,
              height = 0) +
  labs(color = "Field Type", y = "Shannon Diversity", x = "Field Site Code") +
  theme(legend.position = "bottom")
    
tbSpeciesChange %>%
  ggplot() +
  geom_boxplot(aes(siteField, effectiveSR),
               outlier.shape = NA) +
  geom_jitter(aes(siteField, effectiveSR, color = siteType),
              width = 0.1,
              height = 0) +
  labs(color = "Field Type", y = "Effective Species Richness", x = "Field Site Code") +
  theme(legend.position = "bottom")

```




# References

De Cáceres, M., Legendre, P., Wiser, S.K. and Brotons, L. 2012. Using species combinations in indicator analyses. Methods in Ecology and Evolution 3(6): 973-982.

Bakker, J.D., 2008. Increasing the utility of indicator species analysis. Journal of Applied Ecology, 45(6), pp.1829-1835.